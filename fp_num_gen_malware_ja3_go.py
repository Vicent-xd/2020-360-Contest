#coding:utf-8
import pandas as pd
import numpy as np
import glob,os
path=r'./ja3_go/'
malware_ja3_go=pd.read_csv(path+'malware_ja3_go.csv',sep=',',index_col=None,usecols=['ja3s_digest'])
malware_ja3_go_ja3=pd.read_csv(path+'malware_ja3_go.csv',sep=',',index_col=None,usecols=['ja3_digest'])
#malware_ja3_go['fp_nums']=malware_ja3_go['ja3s_digest'].value_counts()
#print(malware_ja3_go)
#print(malware_ja3_go['ja3s_digest'].value_counts())
#ja3s_digest计数
res=malware_ja3_go['ja3s_digest'].value_counts().rename_axis('ja3s_digest').reset_index(name='fp_num')
#ja3_digest计数
ja3_res=malware_ja3_go_ja3['ja3_digest'].value_counts().rename_axis('ja3_digest').reset_index(name='fp_num')
#print(res)
#print(pd.merge(malware_ja3_go,res))

#合并到原始文件并输出(不包含ja3)
malware_ja3_go_full=pd.read_csv(path+'malware_ja3_go.csv',sep=',',index_col=None,usecols=None)
pd1=pd.merge(malware_ja3_go_full,res,how='inner')
#.to_csv('malware_ja3_go_fp_num.csv',index=False,header=True,columns=None)
#合并到原始文件
pd2=pd.merge(malware_ja3_go_full,ja3_res,how='inner')
malware_ja3_go_fp_num=pd1.append(pd2)
malware_ja3_go_fp_num.to_csv('malware_ja3_go_fp_num.csv',index=False,header=True,columns=None)

'''
fp_num=malware_ja3_go['ja3s_digest'].value_counts()
fp_num=pd.DataFrame(fp_num)
'''
#fp_num.columns=['ja3s_digest','fp_num']
#print(fp_num['ja3s_digest'])
#print(pd.concat([malware_ja3_go,fp_num]))